const folders = [
    {
      name: { vi: 'Trước khi học MindX', en: 'Before study at MINDX' },
      images: [
        { src: '../image/image_web/Art/before_mindx/1.1.jpg', short: 'Sketch', desc: 'This is a sketch project' },
        { src: '../image/image_web/Art/before_mindx/1.2.jpg', short: 'Logo', desc: 'This is a logo design' },
        { src: '../image/image_web/Art/before_mindx/1.3.jpg', short: 'UX Flow', desc: 'User experience workflow' },
        { src: '../image/image_web/Art/before_mindx/1.4.jpg', short: 'Wireframe', desc: 'Wireframe design' },
        { src: '../image/image_web/Art/before_mindx/1.5.jpg', short: 'Wireframe', desc: 'Wireframe design' },
        { src: '../image/image_web/Art/before_mindx/1.6.jpg', short: 'Sketch', desc: 'This is a sketch project' },
        { src: '../image/image_web/Art/before_mindx/1.7.jpg', short: 'Logo', desc: 'This is a logo design' },
        { src: '../image/image_web/Art/before_mindx/1.8.jpg', short: 'UX Flow', desc: 'User experience workflow' },
        { src: '../image/image_web/Art/before_mindx/1.9.jpg', short: 'Wireframe', desc: 'Wireframe design' },
        { src: '../image/image_web/Art/before_mindx/1.10.jpg', short: 'Wireframe', desc: 'Wireframe design' },
        { src: '../image/image_web/Art/before_mindx/1.11.jpg', short: 'Sketch', desc: 'This is a sketch project' },
        { src: '../image/image_web/Art/before_mindx/1.12.jpg', short: 'Logo', desc: 'This is a logo design' },
        { src: '../image/image_web/Art/before_mindx/1.13.jpg', short: 'UX Flow', desc: 'User experience workflow' },
        { src: '../image/image_web/Art/before_mindx/1.14.jpg', short: 'Wireframe', desc: 'Wireframe design' },
        { src: '../image/image_web/Art/before_mindx/1.15.jpg', short: 'Wireframe', desc: 'Wireframe design' },
      ]
    },
    {
      name: { vi: 'Trong khi học MindX', en: 'While study in MindX' },
      images: [
        { src: '../image/image_web/Art/while_mindx/2.1.jpg', short: 'Sketch', desc: 'This is a sketch project' },
        { src: '../image/image_web/Art/while_mindx/2.2.jpg', short: 'Logo', desc: 'This is a logo design' },
        { src: '../image/image_web/Art/while_mindx/2.3.jpg', short: 'UX Flow', desc: 'User experience workflow' },
        { src: '../image/image_web/Art/while_mindx/2.4.jpg', short: 'Wireframe', desc: 'Wireframe design' },
        { src: '../image/image_web/Art/while_mindx/2.5.jpg', short: 'Wireframe', desc: 'Wireframe design' },
        { src: '../image/image_web/Art/while_mindx/2.6.jpg', short: 'Sketch', desc: 'This is a sketch project' },
        { src: '../image/image_web/Art/while_mindx/2.7.jpg', short: 'Logo', desc: 'This is a logo design' },
        { src: '../image/image_web/Art/while_mindx/2.8.jpg', short: 'UX Flow', desc: 'User experience workflow' },
        { src: '../image/image_web/Art/while_mindx/2.9.jpg', short: 'Wireframe', desc: 'Wireframe design' },
        { src: '../image/image_web/Art/while_mindx/2.10.jpg', short: 'Wireframe', desc: 'Wireframe design' },
        { src: '../image/image_web/Art/while_mindx/2.11.jpg', short: 'Sketch', desc: 'This is a sketch project' },
        { src: '../image/image_web/Art/while_mindx/2.12.jpg', short: 'Logo', desc: 'This is a logo design' },
        { src: '../image/image_web/Art/while_mindx/2.13.jpg', short: 'UX Flow', desc: 'User experience workflow' },
      ]
    },
    {
        name: { vi: 'Sau khi học MindX', en: 'After study in MindX' },
        images: [
          { src: '../image/image_web/Art/after_mindx/3.1.jpg', short: 'Banner', desc: 'Banner design' },
          { src: '../image/image_web/Art/after_mindx/3.2.jpg', short: 'Banner', desc: 'Banner design' },
        ]
      },
      {
        name: { vi: 'Dự án trong lớp', en: 'Project in class' },
        images: [
            { 
                src: 'https://drive.google.com/file/d/1QHZeZ8usNX-QJCySV5sVkqTqLk2E3ZW-/preview', 
                short: 'Sketch', 
                desc: 'This is a sketch project', 
                type:'drive' 
              },
            { src: '../image/image_web/Art/project_in_class/4.1.jpg', short: 'Logo', desc: 'This is a logo design' },
            { src: '../image/image_web/Art/project_in_class/4.2.jpg', short: 'UX Flow', desc: 'User experience workflow' },
            { src: '../image/image_web/Art/project_in_class/4.3.jpg', short: 'Wireframe', desc: 'Wireframe design' },
            { src: '../image/image_web/Art/project_in_class/4.4.jpg', short: 'Wireframe', desc: 'Wireframe design' },
            { src: '../image/image_web/Art/project_in_class/4.5.jpg', short: 'Sketch', desc: 'This is a sketch project' },
            { src: '../image/image_web/Art/project_in_class/4.6.jpg', short: 'Logo', desc: 'This is a logo design' },
            { src: '../image/image_web/Art/project_in_class/4.7.jpg', short: 'UX Flow', desc: 'User experience workflow' },
            { src: '../image/image_web/Art/project_in_class/4.8.jpg', short: 'Wireframe', desc: 'Wireframe design' },
            { src: '../image/image_web/Art/project_in_class/4.9.jpg', short: 'Wireframe', desc: 'Wireframe design' },
            { src: '../image/image_web/Art/project_in_class/4.10.jpg', short: 'Sketch', desc: 'This is a sketch project' },
            { src: '../image/image_web/Art/project_in_class/4.11.jpg', short: 'Logo', desc: 'This is a logo design' },
            { src: '../image/image_web/Art/project_in_class/4.12.jpg', short: 'UX Flow', desc: 'User experience workflow' },
            { src: '../image/image_web/Art/project_in_class/4.13.jpg', short: 'Sketch', desc: 'This is a sketch project' },
            { src: '../image/image_web/Art/project_in_class/4.14.jpg', short: 'Logo', desc: 'This is a logo design' },
            { src: '../image/image_web/Art/project_in_class/4.15.jpg', short: 'UX Flow', desc: 'User experience workflow' },
            { src: '../image/image_web/Art/project_in_class/4.16.jpg', short: 'Wireframe', desc: 'Wireframe design' },
            { src: '../image/image_web/Art/project_in_class/4.17.jpg', short: 'Wireframe', desc: 'Wireframe design' },
            { src: '../image/image_web/Art/project_in_class/4.18.jpg', short: 'Sketch', desc: 'This is a sketch project' },
            { src: '../image/image_web/Art/project_in_class/4.19.jpg', short: 'Logo', desc: 'This is a logo design' },
            { src: '../image/image_web/Art/project_in_class/4.20.jpg', short: 'UX Flow', desc: 'User experience workflow' },
            { src: '../image/image_web/Art/project_in_class/4.21.jpg', short: 'Wireframe', desc: 'Wireframe design' },
            { src: '../image/image_web/Art/project_in_class/4.22.jpg', short: 'Wireframe', desc: 'Wireframe design' },
            { src: '../image/image_web/Art/project_in_class/4.23.jpg', short: 'Sketch', desc: 'This is a sketch project' },            
        ]
      },
  ];

  let currentOpen = null;
  let currentFolder = null;

  
  function createGallery(folderData) {
    const images = folderData.images || [];
    const wrapper = document.createElement('div');
    wrapper.className = 'gallery-wrapper';

    const gallery = document.createElement('div');
    gallery.className = 'gallery';

    const leftArrow = document.createElement('span');
    leftArrow.className = 'arrow';
    leftArrow.innerHTML = '&#9664;';

    const rightArrow = document.createElement('span');
    rightArrow.className = 'arrow';
    rightArrow.innerHTML = '&#9654;';

    const viewer = document.createElement('div');
    viewer.className = 'image-viewer';

    const desc = document.createElement('div');
    desc.className = 'description';

    leftArrow.onclick = () => scrollImages(-1, viewer);
    rightArrow.onclick = () => scrollImages(1, viewer);

    images.forEach((imgObj) => {
      const box = document.createElement('div');
      box.className = 'image-box';

      let media;
      if (imgObj.type === 'video') {
        media = document.createElement('video');
        media.src = imgObj.src;
        media.controls = true;
      } else if (imgObj.type === 'drive') {
        const previewLink = imgObj.src.replace('/view?usp=sharing', '/preview');
        media = document.createElement('iframe');
        media.src = previewLink;
        media.width = 300;
        media.height = 200;
        media.allow = 'autoplay';
      } else {
        media = document.createElement('img');
        media.src = imgObj.src;
        media.alt = imgObj.short;
      }

      media.onclick = () => desc.textContent = imgObj.desc;

      const overlay = document.createElement('div');
      overlay.className = 'overlay';
      overlay.textContent = imgObj.short;

      box.appendChild(media);
      box.appendChild(overlay);
      viewer.appendChild(box);
    });

    gallery.appendChild(leftArrow);
    gallery.appendChild(viewer);
    gallery.appendChild(rightArrow);
    wrapper.appendChild(gallery);
    wrapper.appendChild(desc);

    return wrapper;
  }

  function scrollImages(direction, viewer) {
    const scrollAmount = viewer.querySelector('.image-box')?.offsetWidth + 10 || 190;
    viewer.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
  }

  function loadFolders() {
    const folderList = document.getElementById('folder-list');
    folderList.innerHTML = '';
    currentOpen = null;
    currentFolder = null;

    folders.forEach(folderData => {
      const folder = document.createElement('div');
      folder.className = 'folder';
      folder.innerHTML = `
        <span class="lang vi">${folderData.name.vi}</span>
        <span class="lang en" style="display:none">${folderData.name.en}</span>
      `;

      folder.onclick = () => {
        if (currentFolder === folder) {
          currentOpen.classList.remove('open');
          const toRemove = currentOpen;
          currentOpen = null;
          currentFolder = null;
          setTimeout(() => folderList.removeChild(toRemove), 500);
          return;
        }

        if (currentOpen) {
          currentOpen.classList.remove('open');
          const toRemove = currentOpen;
          currentOpen = null;
          currentFolder = null;
          setTimeout(() => folderList.removeChild(toRemove), 500);
        }

        const galleryWrapper = createGallery(folderData);
        folderList.insertBefore(galleryWrapper, folder.nextSibling);
        setTimeout(() => galleryWrapper.classList.add('open'), 10);
        currentOpen = galleryWrapper;
        currentFolder = folder;
      };

      folderList.appendChild(folder);
    });
  }

  function toggleLanguage() {
    const htmlLang = document.documentElement.lang;
    const newLang = htmlLang === 'vi' ? 'en' : 'vi';
    document.documentElement.lang = newLang;

    document.querySelectorAll('.lang.vi').forEach(el => el.style.display = newLang === 'vi' ? 'inline' : 'none');
    document.querySelectorAll('.lang.en').forEach(el => el.style.display = newLang === 'en' ? 'inline' : 'none');

    const flag = document.getElementById('flagIcon');
    if (flag) {
      flag.src = newLang === 'vi'
        ? 'https://flagcdn.com/w40/vn.png'
        : 'https://flagcdn.com/w40/us.png';
    }
  }

  document.getElementById('langToggle').onclick = toggleLanguage;
  loadFolders();